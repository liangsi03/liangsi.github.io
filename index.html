<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="心有猛虎，细嗅蔷薇">
<meta property="og:type" content="website">
<meta property="og:title" content="筱沫私房菜">
<meta property="og:url" content="https://liangsi.github.io/index.html">
<meta property="og:site_name" content="筱沫私房菜">
<meta property="og:description" content="心有猛虎，细嗅蔷薇">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="筱沫私房菜">
<meta name="twitter:description" content="心有猛虎，细嗅蔷薇">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://liangsi.github.io/"/>





  <title> 筱沫私房菜 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">筱沫私房菜</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">little little flower</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/27/python pip常用命令/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/27/python pip常用命令/" itemprop="url">
                  python pip 常用命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-27T14:56:07+08:00">
                2017-04-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/小工具/" itemprop="url" rel="index">
                    <span itemprop="name">小工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="列出已安装的包"><a href="#列出已安装的包" class="headerlink" title="列出已安装的包"></a>列出已安装的包</h2><p>pip freeze or pip list</p>
<h2 id="导出requirements-txt"><a href="#导出requirements-txt" class="headerlink" title="导出requirements.txt"></a>导出requirements.txt</h2><p>pip freeze &gt; &lt;目录&gt;/requirements.txt</p>
<h2 id="安装包"><a href="#安装包" class="headerlink" title="安装包"></a>安装包</h2><h3 id="在线安装"><a href="#在线安装" class="headerlink" title="在线安装"></a>在线安装</h3><p>pip install &lt;包名&gt; 或 pip install -r requirements.txt</p>
<p>通过使用== &gt;= &lt;= &gt; &lt;来指定版本，不写则安装最新版</p>
<p>requirements.txt内容格式为：</p>
<p>APScheduler==2.1.2<br>Django==1.5.4<br>MySQL-Connector-Python==2.0.1<br>MySQL-python==1.2.3<br>PIL==1.1.7<br>South==1.0.2<br>django-grappelli==2.6.3<br>django-pagination==1.0.7</p>
<h3 id="安装本地安装包"><a href="#安装本地安装包" class="headerlink" title="安装本地安装包"></a>安装本地安装包</h3><p>pip install &lt;目录&gt;/&lt;文件名&gt; 或 pip install –use-wheel –no-index –find-links=wheelhouse/ &lt;包名&gt;</p>
<p>&lt;包名&gt;前有空格</p>
<p>可简写为</p>
<p>pip install –no-index -f=&lt;目录&gt;/ &lt;包名&gt;</p>
<h2 id="卸载包"><a href="#卸载包" class="headerlink" title="卸载包"></a>卸载包</h2><p>pip uninstall &lt;包名&gt; 或 pip uninstall -r requirements.txt</p>
<h2 id="升级包"><a href="#升级包" class="headerlink" title="升级包"></a>升级包</h2><p>pip install -U &lt;包名&gt;</p>
<p>或：pip install &lt;包名&gt; –upgrade</p>
<h2 id="升级pip"><a href="#升级pip" class="headerlink" title="升级pip"></a>升级pip</h2><p>pip install -U pip</p>
<h2 id="显示包所在的目录"><a href="#显示包所在的目录" class="headerlink" title="显示包所在的目录"></a>显示包所在的目录</h2><p>pip show -f &lt;包名&gt;</p>
<h2 id="搜索包"><a href="#搜索包" class="headerlink" title="搜索包"></a>搜索包</h2><p>pip search &lt;搜索关键字&gt;</p>
<h2 id="查询可升级的包"><a href="#查询可升级的包" class="headerlink" title="查询可升级的包"></a>查询可升级的包</h2><p>pip list -o</p>
<h2 id="下载包而不安装"><a href="#下载包而不安装" class="headerlink" title="下载包而不安装"></a>下载包而不安装</h2><p>pip install &lt;包名&gt; -d &lt;目录&gt; 或 pip install -d &lt;目录&gt; -r requirements.txt</p>
<h2 id="打包"><a href="#打包" class="headerlink" title="打包"></a>打包</h2><p>pip wheel &lt;包名&gt;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/27/git常用命令行/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/27/git常用命令行/" itemprop="url">
                  git常用命令行
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-27T14:54:46+08:00">
                2017-04-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>git init 初始化代码仓库<br>git add <dir|file> 把目录/文件加入版本控制<br>git status 查看版本控制的状态<br>vim .gitignore 加入忽略文件列表<br>git reset 重置版本控制状态<br>git commit -a -m ‘msg’ 提交文件到本地仓库<br>git log 查看提交的历史版本<br>git push 将本地仓库提交到远程仓库<br>git pull 将远程仓库拉到本地仓库<br>git checkout -f [logid] 本地仓库检出</dir|file></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/26/图片水印识别的各种尝试/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/26/图片水印识别的各种尝试/" itemprop="url">
                  图片水印识别的各种尝试
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-26T10:49:23+08:00">
                2017-04-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="图片分类"><a href="#图片分类" class="headerlink" title="图片分类"></a>图片分类</h2><p>1.抽取特征<br>SIFT，SURF，HOG，颜色等等<br>然后SVM分类<br>如果没有水印的召回率特别高，可以结合搜这个结果<br>参考链接：<br>scikit Image:sklean<br><a href="http://scikit-learn.org/stable/" target="_blank" rel="external">http://scikit-learn.org/stable/</a></p>
<h2 id="图片目标识别"><a href="#图片目标识别" class="headerlink" title="图片目标识别"></a>图片目标识别</h2><p>把水印当做目标</p>
<h2 id="图片目标识别中比较高级的方法"><a href="#图片目标识别中比较高级的方法" class="headerlink" title="图片目标识别中比较高级的方法"></a>图片目标识别中比较高级的方法</h2><p>1.fast rcnn<br>参考链接<br><a href="http://www.cnblogs.com/louyihang-loves-baiyan/p/4885659.html?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="external">http://www.cnblogs.com/louyihang-loves-baiyan/p/4885659.html?utm_source=tuicool&amp;utm_medium=referral</a><br><a href="http://www.cnblogs.com/louyihang-loves-baiyan/p/4903231.html" target="_blank" rel="external">http://www.cnblogs.com/louyihang-loves-baiyan/p/4903231.html</a><br><a href="http://www.cnblogs.com/louyihang-loves-baiyan/p/4906690.html" target="_blank" rel="external">http://www.cnblogs.com/louyihang-loves-baiyan/p/4906690.html</a><br><a href="http://blog.csdn.net/smf0504/article/details/52751251" target="_blank" rel="external">http://blog.csdn.net/smf0504/article/details/52751251</a></p>
<h2 id="其他教程"><a href="#其他教程" class="headerlink" title="其他教程"></a>其他教程</h2><p>1.定向梯度和物体检测直方图<br><a href="http://www.pyimagesearch.com/2014/11/10/histogram-oriented-gradients-object-detection/" target="_blank" rel="external">http://www.pyimagesearch.com/2014/11/10/histogram-oriented-gradients-object-detection/</a><br>2.图形金字塔与Python和OpenCV<br><a href="http://www.pyimagesearch.com/2015/03/16/image-pyramids-with-python-and-opencv/" target="_blank" rel="external">http://www.pyimagesearch.com/2015/03/16/image-pyramids-with-python-and-opencv/</a><br>3.使用Python和OpenCV来滑动Windows对象检测<br><a href="http://www.pyimagesearch.com/2015/03/23/sliding-windows-for-object-detection-with-python-and-opencv/" target="_blank" rel="external">http://www.pyimagesearch.com/2015/03/23/sliding-windows-for-object-detection-with-python-and-opencv/</a><br>4.Non-Maximum Suppression for Object Detection in Python<br><a href="http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/" target="_blank" rel="external">http://www.pyimagesearch.com/2014/11/17/non-maximum-suppression-object-detection-python/</a><br>5.(Faster) Non-Maximum Suppression in Python<br><a href="http://www.pyimagesearch.com/2015/02/16/faster-non-maximum-suppression-python/" target="_blank" rel="external">http://www.pyimagesearch.com/2015/02/16/faster-non-maximum-suppression-python/</a><br>6.Texture Matching using Local Binary Patterns (LBP), OpenCV, scikit-learn and Python<br><a href="http://hanzratech.in/2015/05/30/local-binary-patterns.html" target="_blank" rel="external">http://hanzratech.in/2015/05/30/local-binary-patterns.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/20/python自动重命名文件下全部图片/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/20/python自动重命名文件下全部图片/" itemprop="url">
                  python自动重命名文件下全部图片
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-20T18:47:40+08:00">
                2017-04-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/小工具/" itemprop="url" rel="index">
                    <span itemprop="name">小工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>直接上代码，亲测有效，如果有问题，我都懒得理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"># -*- coding:utf8 -*-</div><div class="line"></div><div class="line">import os</div><div class="line"></div><div class="line">class BatchRename():</div><div class="line">    &apos;&apos;&apos;</div><div class="line">    批量重命名文件夹中的图片文件</div><div class="line"></div><div class="line">    &apos;&apos;&apos;</div><div class="line">    def __init__(self):</div><div class="line">        self.path = &apos;/Users/liangsi/Downloads/watermask/train/nohave&apos;</div><div class="line"></div><div class="line">    def rename(self):</div><div class="line">        filelist = os.listdir(self.path)</div><div class="line">        total_num = len(filelist)</div><div class="line">        i = 0</div><div class="line">        for item in filelist:</div><div class="line">            if item.endswith(&apos;.jpg&apos;):</div><div class="line">                src = os.path.join(os.path.abspath(self.path), item)</div><div class="line">                dst = os.path.join(os.path.abspath(self.path), str(i) + &apos;.jpg&apos;)</div><div class="line">                try:</div><div class="line">                    os.rename(src, dst)</div><div class="line">                    print &apos;converting %s to %s ...&apos; % (src, dst)</div><div class="line">                    i = i + 1</div><div class="line">                except:</div><div class="line">                    continue</div><div class="line">        print &apos;total %d to rename &amp; converted %d jpgs&apos; % (total_num, i)</div><div class="line"></div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    demo = BatchRename()</div><div class="line">    demo.rename()</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/18/通过python下载图片/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/18/通过python下载图片/" itemprop="url">
                  通过python下载图片
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-18T18:55:49+08:00">
                2017-04-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/小工具/" itemprop="url" rel="index">
                    <span itemprop="name">小工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>代码，自己写的，有问题也别找我：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">#-*- coding: UTF-8 -*- </div><div class="line">##liangsi 2017-04-18</div><div class="line">##通过csv中明细下载文件并重命名</div><div class="line">import urllib2</div><div class="line">from PIL import Image</div><div class="line">import cStringIO</div><div class="line">import csv</div><div class="line">def ImageScale(url):</div><div class="line">	file = cStringIO.StringIO(urllib2.urlopen(url).read())</div><div class="line">	img = Image.open(file)</div><div class="line">	return img</div><div class="line">    ##img.show()</div><div class="line"></div><div class="line">csv_reader = csv.reader(open(&apos;/Users/liangsi/Downloads/pic.csv&apos;))</div><div class="line">for row in csv_reader:</div><div class="line">	url = &apos;&apos;.join(row).split(&quot;\t&quot;)[1]</div><div class="line">	try:</div><div class="line">		img = ImageScale(url)</div><div class="line">		a = &apos;&apos;.join(row).split(&quot;	&quot;)[0]+&quot;_&quot;</div><div class="line">		img.save(&apos;/Users/liangsi/Downloads/watermask/train/%s.jpg&apos;%a)</div><div class="line">	except urllib2.URLError, e:</div><div class="line">		print e.reason</div><div class="line">		print &quot;下载失败的url:&quot;,url</div><div class="line">	##img.show()</div></pre></td></tr></table></figure></p>
<p>碎碎念：写这个的目的，只是不想一个个保存图片。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/14/图片相似度/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/14/图片相似度/" itemprop="url">
                  图片相似度
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-14T16:35:59+08:00">
                2017-04-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/图像处理/" itemprop="url" rel="index">
                    <span itemprop="name">图像处理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.感知哈希</p>
<p>参考链接：<br><a href="http://www.cnblogs.com/lxy2017/p/3945278.html" target="_blank" rel="external">http://www.cnblogs.com/lxy2017/p/3945278.html</a><br><a href="http://blog.csdn.net/zouxy09/article/details/17471401" target="_blank" rel="external">http://blog.csdn.net/zouxy09/article/details/17471401</a></p>
<p>2.DCT<br>参考链接：<br><a href="http://blog.csdn.net/zxc024000/article/details/49429405" target="_blank" rel="external">http://blog.csdn.net/zxc024000/article/details/49429405</a></p>
<p>3.直方图</p>
<p>参考链接：<br><a href="http://blog.sina.com.cn/s/blog_b27f71160101gpep.html" target="_blank" rel="external">http://blog.sina.com.cn/s/blog_b27f71160101gpep.html</a><br><a href="http://blog.csdn.net/jiandanjinxin/article/details/51281924" target="_blank" rel="external">http://blog.csdn.net/jiandanjinxin/article/details/51281924</a></p>
<p>4.代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line">#-*- coding: UTF-8 -*- </div><div class="line">from glob import glob</div><div class="line">from PIL import Image</div><div class="line">import math</div><div class="line">## Created by ls 2017-04-14</div><div class="line">def phash_avghash(im):</div><div class="line">    im = im.resize((8, 8)).convert(&apos;L&apos;)</div><div class="line">    avg = reduce(lambda x, y: x + y, im.getdata()) / 64.</div><div class="line">    avg = sum(im.getdata()) / 64.</div><div class="line">    return reduce(lambda x, (y, z): x | (z &lt;&lt; y),</div><div class="line">                  enumerate(map(lambda i: 0 if i &lt; avg else 1, im.getdata())),</div><div class="line">                  0)</div><div class="line"></div><div class="line">def phash_dct(im):</div><div class="line">    im = im.resize((32, 32)).convert(&apos;L&apos;)</div><div class="line">    seq = [sum(im.getpixel((x, y)) *</div><div class="line">               math.cos(math.pi / 32 * (x + .5) * u) *</div><div class="line">               math.cos(math.pi / 32 * (y + .5) * v)</div><div class="line">               for x in range(32) for y in range(32))</div><div class="line">           for v in range(8) for u in range(8)]</div><div class="line">    avg = sum(seq[1:]) / (len(seq) - 1)</div><div class="line">    return reduce(lambda x, (y, z): x | (z &lt;&lt; y),</div><div class="line">                  enumerate(map(lambda i: 0 if i &lt; avg else 1, seq)),</div><div class="line">                  0)</div><div class="line"></div><div class="line">def phash_histogram(im):</div><div class="line">    return im.resize((100, 100)).convert(&apos;P&apos;).histogram()</div><div class="line">    ##histogram直方图</div><div class="line">    ##convert类型转换</div><div class="line"></div><div class="line">def diff_1(h1, h2):</div><div class="line">    h, d = 0, h1 ^ h2</div><div class="line">    while d:</div><div class="line">        h += 1</div><div class="line">        d &amp;= d - 1</div><div class="line">    return h</div><div class="line"></div><div class="line">    </div><div class="line">def diff_2(h1, h2):</div><div class="line">    acc = 0</div><div class="line">    for a, b in zip(h1, h2):</div><div class="line">        acc += abs(a - b)</div><div class="line">    return acc</div><div class="line"></div><div class="line">if __name__ == &apos;__main__&apos;:</div><div class="line">    target = Image.open(&apos;/Users/liangsi/Downloads/感知phash－图片相似性/9.jpg&apos;)</div><div class="line">    test = Image.open(&apos;/Users/liangsi/Downloads/感知phash－图片相似性/10.jpg&apos;)</div><div class="line">    ##提取中间部分图像</div><div class="line">    target = target.resize((256, 256))</div><div class="line">    test = test.resize((256,256))</div><div class="line">    box = (50,50,210,210)</div><div class="line">    target = target.crop(box) </div><div class="line">    test = test.crop(box)</div><div class="line">    ##avg数据--哈希</div><div class="line">    target_avg = phash_avghash(target)</div><div class="line">    test_avg = phash_avghash(test)</div><div class="line">    diff_avg = diff_1(target_avg,test_avg)</div><div class="line">    ##dct数据-余弦变化</div><div class="line">    target_dct = phash_dct(target)</div><div class="line">    test_dct = phash_dct(test)</div><div class="line">    diff_dct = diff_1(target_dct,test_dct)</div><div class="line">    ##histogram--直方图</div><div class="line">    target_his = phash_histogram(target)</div><div class="line">    test_his = phash_histogram(test)</div><div class="line">    diff_his = diff_2(target_his,test_his)</div><div class="line"></div><div class="line">    result = diff_avg+diff_dct+diff_his/1000</div><div class="line">    if result&lt;10:</div><div class="line">        print &quot;diff_avg结果:&quot;,diff_avg</div><div class="line">        print &quot;diff_dct结果:&quot;,diff_dct</div><div class="line">        print &quot;diff_his结果:&quot;,diff_his</div><div class="line">        print &quot;最后整合结果:&quot;,result</div><div class="line">        print&quot;判断结果：是相似图片&quot;</div><div class="line">    else:</div><div class="line">        print &quot;diff_avg结果:&quot;,diff_avg</div><div class="line">        print &quot;diff_dct结果:&quot;,diff_dct</div><div class="line">        print &quot;diff_his结果:&quot;,diff_his</div><div class="line">        print &quot;最后整合结果:&quot;,result</div><div class="line">        print &quot;判断结果：不是相似图片&quot;</div></pre></td></tr></table></figure></p>
<p>5.结果<br>图一：<br><img src="/2017/04/14/图片相似度/1.png" alt="原始图)"><br>图二：<br><img src="/2017/04/14/图片相似度/2.jpg" alt="mask)"><br>图一和图二的相似性结果：<br><img src="/2017/04/14/图片相似度/result1.png" alt="结果图)"><br>图三：<br><img src="/2017/04/14/图片相似度/3.jpg" alt="原始图)"><br>图四：<br><img src="/2017/04/14/图片相似度/4.jpg" alt="mask)"><br>图三和图四的相似性结果：<br><img src="/2017/04/14/图片相似度/result2.png" alt="结果图)"></p>
<p>6.其他参考<br>通常判断相似度计算get psnr和CSH 一致性哈希<br>CSH的参考链接：<br><a href="http://www.eng.tau.ac.il/~simonk/CSH/index.html" target="_blank" rel="external">http://www.eng.tau.ac.il/~simonk/CSH/index.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/13/如何在文章中添加图片/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/13/如何在文章中添加图片/" itemprop="url">
                  如何在文章中添加图片
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-13T17:21:44+08:00">
                2017-04-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/小技能/" itemprop="url" rel="index">
                    <span itemprop="name">小技能</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.修改主页配置文件_config.yml</p>
<p>把里面的post_asset_folder:这个选项设置为true</p>
<p>2.安装本地图片上传插件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-asset-image --save</div></pre></td></tr></table></figure></p>
<p>3.生成新的md文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo n &quot;xxxx&quot;</div></pre></td></tr></table></figure></p>
<p>待生成完成后/source/_posts文件夹内除了xxxx.md文件还有一个同名的文件夹</p>
<p>4.xxxx.md文件中插入图片</p>
<p>先把图片复制到xxxx这个文件夹中</p>
<p>然后只需要在xxxx.md中按照markdown的格式引入图片：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">![你想输入的替代文字](xxxx/图片名.jpg)**</div></pre></td></tr></table></figure></p>
<p>5.最后检查一下，hexo g生成页面后.<br>进入public\2017\02\26\index.html文件中查看相关字段，可以发现，html标签内的语句是<strong>img src=”2017/02/26/xxxx/图片名.jpg”</strong>，而不是<strong>img src=”xxxx/图片名.jpg”</strong>.</p>
<p>致：我尝试了无数遍终于添加进去的图片。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/13/使用opencvImage-Inpainting备份/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/13/使用opencvImage-Inpainting备份/" itemprop="url">
                  使用opencv Image Inpainting备份
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-13T15:32:06+08:00">
                2017-04-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/图像算法/" itemprop="url" rel="index">
                    <span itemprop="name">图像算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-opencv的inpainting的说明"><a href="#1-opencv的inpainting的说明" class="headerlink" title="1.opencv的inpainting的说明"></a>1.opencv的inpainting的说明</h2><p><strong>需要有一定的mask辅助</strong></p>
<p>参考链接：<br><a href="http://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_photo/py_inpainting/py_inpainting.html" target="_blank" rel="external">http://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_photo/py_inpainting/py_inpainting.html</a></p>
<h2 id="2-可以利用mask去水印，去杂质和黑点"><a href="#2-可以利用mask去水印，去杂质和黑点" class="headerlink" title="2.可以利用mask去水印，去杂质和黑点"></a>2.可以利用mask去水印，去杂质和黑点</h2><p><strong>CSDN博客例子</strong></p>
<p>参考链接：<br><a href="http://blog.csdn.net/carson2005/article/details/6844025" target="_blank" rel="external">http://blog.csdn.net/carson2005/article/details/6844025</a></p>
<h2 id="3-inpating的例子，来自github"><a href="#3-inpating的例子，来自github" class="headerlink" title="3.inpating的例子，来自github"></a>3.inpating的例子，来自github</h2><p>参考链接：<br><a href="https://github.com/liangsi03/AutomaticImageInpainting" target="_blank" rel="external">https://github.com/liangsi03/AutomaticImageInpainting</a></p>
<h2 id="4-实例代码"><a href="#4-实例代码" class="headerlink" title="4.实例代码"></a>4.实例代码</h2><p><strong>1.使用MATLAB制作mask</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">srcFiles = dir(&apos;/Users/liangsi/Downloads/AutomaticImageInpainting/Testdata/DamagedData/*.jpg&apos;);  % the folder in which ur images exists</div><div class="line">for i = 1 : length(srcFiles)</div><div class="line">    filename = strcat(&apos;/Users/liangsi/Downloads/AutomaticImageInpainting/Testdata/DamagedData/&apos;,srcFiles(i).name);</div><div class="line">    images = imread(filename);</div><div class="line">    %figure,imshow(images);</div><div class="line">    grayImages = rgb2gray(images);</div><div class="line">    %figure,imshow(grayImages);</div><div class="line">    noise = imnoise(grayImages,&apos;salt &amp; pepper&apos;, 0.02);</div><div class="line">    %figure,imshow(noise);</div><div class="line">    FCM = medfilt2(noise);</div><div class="line">    %figure,imshow(FCM);</div><div class="line">    defect = imabsdiff(grayImages,FCM);</div><div class="line">    %figure,imshow(defect);</div><div class="line">    mask = im2bw(defect, 0.20);</div><div class="line">    %figure,imshow(mask);</div><div class="line">   figure, subplot(1,2,1), imshow(images)</div><div class="line">    subplot(1,2,2), imshow(mask)</div><div class="line">    img_mask = sprintf(&apos;/Users/liangsi/Downloads/AutomaticImageInpainting/Testdata/Masks/image_mask%d.jpg&apos;,i);</div><div class="line">    imwrite(mask, img_mask);  </div><div class="line">end</div></pre></td></tr></table></figure></p>
<p><strong>2.使用inpating处理图片</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">import os</div><div class="line">from os import listdir</div><div class="line">from os.path import isfile, join</div><div class="line">import numpy</div><div class="line">import cv2</div><div class="line"></div><div class="line">path1=&apos;/Users/liangsi/Downloads/AutomaticImageInpainting/Testdata/DamagedData&apos;</div><div class="line">path2=&apos;/Users/liangsi/Downloads/AutomaticImageInpainting/Testdata/Masks&apos;</div><div class="line">damagefiles = [ f for f in listdir(path1) if isfile(join(path1,f)) ]</div><div class="line">masks = [ j for j in listdir(path2) if isfile(join(path2,j)) ]</div><div class="line"></div><div class="line">damage_img = numpy.empty(len(damagefiles), dtype=object)</div><div class="line">mask_img = numpy.empty(len(masks), dtype=object)</div><div class="line"></div><div class="line">for n in range(0, len(damagefiles)):</div><div class="line">  damage_img[n] = cv2.imread( join(path1,damagefiles[n]) )</div><div class="line">  mask_img[n] = cv2.imread( join(path2,masks[n]),0 )</div><div class="line">  inpaint_img = cv2.inpaint(damage_img[n],mask_img[n],3,cv2.INPAINT_TELEA)</div><div class="line">  os.chdir(&quot;/Users/liangsi/Downloads/AutomaticImageInpainting/Testdata/DamagedData/ImpaintedImages&quot;)</div><div class="line">  cv2.imwrite(&quot;inpainted_img(&quot;+str(n+1)+&quot;).jpg&quot;,inpaint_img)</div><div class="line">  cv2.imshow(&apos;Image&apos;,inpaint_img)</div><div class="line">  cv2.waitKey(1000)</div><div class="line">  cv2.destroyAllWindows()</div></pre></td></tr></table></figure></p>
<p><strong>3.结果：</strong><br>原始图：<br><img src="/2017/04/13/使用opencvImage-Inpainting备份/inpating_1.jpg" alt="原始图)"><br>mask：<br><img src="/2017/04/13/使用opencvImage-Inpainting备份/inpating_2.jpg" alt="mask)"><br>结果图：<br><img src="/2017/04/13/使用opencvImage-Inpainting备份/inpating_3.jpg" alt="结果图)"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/06/mac上在python基础上安装opencv/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/06/mac上在python基础上安装opencv/" itemprop="url">
                  mac上在python基础上安装opencv
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-06T18:10:28+08:00">
                2017-04-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/小技能/" itemprop="url" rel="index">
                    <span itemprop="name">小技能</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>需安装如下</strong>：</p>
<p>1.安装Homebrew<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</div></pre></td></tr></table></figure></p>
<p>2.安装Python及numpy等包(自行搞定)</p>
<p>3.添加science仓库</p>
<p>4.安装opencv<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install opencv</div></pre></td></tr></table></figure></p>
<p>5.修改合并路径<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir -p /Users/zgf/Library/Python/2.7/lib/python/site-packages</div><div class="line">echo &apos;import site; site.addsitedir(&quot;/usr/local/lib/python2.7/site-packages&quot;)&apos; &gt;&gt; /Users/zgf/Library/Python/2.7/lib/python/site-packages/homebrew.pth</div></pre></td></tr></table></figure></p>
<p>备注：通常import cv2需要安装。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://liangsi.github.io/2017/04/01/人脸识别/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liangsi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/1.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="筱沫私房菜">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/01/人脸识别/" itemprop="url">
                  人脸识别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-01T15:24:10+08:00">
                2017-04-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/自然语言处理/" itemprop="url" rel="index">
                    <span itemprop="name">自然语言处理</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>说明：人脸识别实例</p>
<h2 id="提前安装"><a href="#提前安装" class="headerlink" title="提前安装"></a>提前安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1.anaconda-python</div><div class="line">2.Dlib</div><div class="line">   pip install dlib</div><div class="line">3.scikit-image </div><div class="line">   pip install scikit-image</div></pre></td></tr></table></figure>
<h2 id="人脸识别"><a href="#人脸识别" class="headerlink" title="人脸识别"></a>人脸识别</h2><p>之所以用Dlib来实现人脸识别，是因为它已经替我们做好了绝大部分的工作，我们只需要去调用就行了。Dlib里面有人脸检测器，有训练好的人脸关键点检测器，也有训练好的人脸识别模型。准备了六个候选人的图片放在candidate-faces文件夹中，然后需要识别的人脸图片test.jpg。我们的工作就是要检测到test.jpg中的人脸，然后判断她到底是候选人中的谁。另外的girl-face-rec.py是我们的python脚本。shape_predictor_68_face_landmarks.dat是已经训练好的人脸关键点检测器。dlib_face_recognition_resnet_model_v1.dat是训练好的ResNet人脸识别模型。ResNet是何凯明在微软的时候提出的深度残差网络，获得了 ImageNet 2015 冠军，通过让网络对残差进行学习，在深度和精度上做到了比CNN 更加强大。</p>
<h2 id="1-前期准备"><a href="#1-前期准备" class="headerlink" title="1.前期准备"></a>1.前期准备</h2><ul>
<li>shape_predictor_68_face_landmarks.dat和dlib_face_recognition_resnet_model_v1.dat都可以在这里找到。不能点击超链接的可以直接点开此网址：<a href="http://dlib.net/files/" target="_blank" rel="external">http://dlib.net/files/</a>。</li>
<li>然后准备几个人的人脸图片作为候选人脸，最好是正脸。放到candidate-faces文件夹中。</li>
</ul>
<h2 id="2-识别流程"><a href="#2-识别流程" class="headerlink" title="2.识别流程"></a>2.识别流程</h2><ul>
<li>数据准备完毕，接下来就是代码了。识别的大致流程是这样的：</li>
<li>先对候选人进行人脸检测、关键点提取、描述子生成后，把候选人描述子保存起来。</li>
<li>然后对测试人脸进行人脸检测、关键点提取、描述子生成。</li>
<li>最后求测试图像人脸描述子和候选人脸描述子之间的欧氏距离，距离最小者判定为同一个人。</li>
</ul>
<h2 id="3-代码"><a href="#3-代码" class="headerlink" title="3.代码"></a>3.代码</h2><p>代码不做过多解释，因为已经注释的非常完善了。以下是girl-face-rec.python<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"># -*- coding: UTF-8 -*-</div><div class="line">import sys,os,dlib,glob,numpy</div><div class="line">from skimage import io</div><div class="line">if len(sys.argv) != 5:</div><div class="line">    print &quot;请检查参数是否正确&quot;</div><div class="line">    exit()</div><div class="line"># 1.人脸关键点检测器</div><div class="line">predictor_path = sys.argv[1]</div><div class="line"># 2.人脸识别模型</div><div class="line">face_rec_model_path = sys.argv[2]</div><div class="line"># 3.候选人脸文件夹</div><div class="line">faces_folder_path = sys.argv[3]</div><div class="line"># 4.需识别的人脸</div><div class="line">img_path = sys.argv[4]</div><div class="line"># 1.加载正脸检测器</div><div class="line">detector = dlib.get_frontal_face_detector()</div><div class="line"># 2.加载人脸关键点检测器</div><div class="line">sp = dlib.shape_predictor(predictor_path)</div><div class="line"># 3. 加载人脸识别模型</div><div class="line">facerec = dlib.face_recognition_model_v1(face_rec_model_path)</div><div class="line"># win = dlib.image_window()</div><div class="line"># 候选人脸描述子list</div><div class="line">descriptors = []</div><div class="line"># 对文件夹下的每一个人脸进行:</div><div class="line"># 1.人脸检测</div><div class="line"># 2.关键点检测</div><div class="line"># 3.描述子提取</div><div class="line">for f in glob.glob(os.path.join(faces_folder_path, &quot;*.jpg&quot;)):</div><div class="line">    print(&quot;Processing file: &#123;&#125;&quot;.format(f))</div><div class="line">    img = io.imread(f)</div><div class="line">    #win.clear_overlay()</div><div class="line">    #win.set_image(img)</div><div class="line">    # 1.人脸检测</div><div class="line">    dets = detector(img, 1)</div><div class="line">    print(&quot;Number of faces detected: &#123;&#125;&quot;.format(len(dets)))</div><div class="line">    for k, d in enumerate(dets):  </div><div class="line">    # 2.关键点检测</div><div class="line">    shape = sp(img, d)</div><div class="line">     # 画出人脸区域和和关键点</div><div class="line">        # win.clear_overlay()</div><div class="line">        # win.add_overlay(d)</div><div class="line">        # win.add_overlay(shape)</div><div class="line">        # 3.描述子提取，128D向量</div><div class="line">        face_descriptor = facerec.compute_face_descriptor(img, shape)</div><div class="line">        # 转换为numpy array</div><div class="line">        v = numpy.array(face_descriptor)  </div><div class="line">        descriptors.append(v)</div><div class="line"># 对需识别人脸进行同样处理</div><div class="line"># 提取描述子，不再注释</div><div class="line">img = io.imread(img_path)</div><div class="line">dets = detector(img, 1)</div><div class="line">dist = []</div><div class="line">for k, d in enumerate(dets):</div><div class="line">shape = sp(img, d)</div><div class="line"> face_descriptor = facerec.compute_face_descriptor(img, shape)</div><div class="line"> d_test = numpy.array(face_descriptor) </div><div class="line">    # 计算欧式距离</div><div class="line">    for i in descriptors:</div><div class="line">        dist_ = numpy.linalg.norm(i-d_test)</div><div class="line">        dist.append(dist_)</div><div class="line"># 候选人名单</div><div class="line">candidate = [&apos;Unknown1&apos;,&apos;Unknown2&apos;,&apos;Shishi&apos;,&apos;Unknown4&apos;,&apos;Bingbing&apos;,&apos;Feifei&apos;]</div><div class="line"># 候选人和距离组成一个dict</div><div class="line">c_d = dict(zip(candidate,dist))</div><div class="line">cd_sorted = sorted(c_d.iteritems(), key=lambda d:d[1])</div><div class="line">print &quot;\n The person is: &quot;,cd_sorted[0][0]  </div><div class="line">dlib.hit_enter_to_continue()</div></pre></td></tr></table></figure></p>
<h2 id="4-运行结果"><a href="#4-运行结果" class="headerlink" title="4.运行结果"></a>4.运行结果</h2><p>我们在.py所在的文件夹下打开命令行，运行如下命令<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python girl-face-rec.py 1.dat 2.dat ./candidate-faecs test1.jpg</div></pre></td></tr></table></figure></p>
<p>由于shape_predictor_68_face_landmarks.dat和dlib_face_recognition_resnet_model_v1.dat名字实在太长，所以我把它们重命名为1.dat和2.dat。<br>运行结果如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">The person is XXX。</div></pre></td></tr></table></figure></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://mp.weixin.qq.com/s?__biz=MzA5MzY4NTQwMA==&amp;mid=2650996942&amp;idx=1&amp;sn=02c335aeb0a431b361bc3ca90a9f8c8f&amp;chksm=8badb339bcda3a2f4ec026c80801cde6d13525cf0e8086fdddbb296c81ca6376fee03051bb88&amp;scene=0&amp;key=cd1928819323f84574591249d8d3b9558858fe07bf89a18626fdd6898b1737bb4416db7ace18aa87a5cfccb1f8648859e19f4abbba71899999dbe650037ac3b1dd755384fcad1b5ee43178472da4e306&amp;ascene=0&amp;uin=Njc2NjQ1NjIw&amp;devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.12+build(16A323)&amp;version=12010210&amp;nettype=WIFI&amp;fontScale=100&amp;pass_ticket=xhlLfolsnfhQZK9MMVf8vkzOlZJ8R2EHJTl74x7elmy%2FXOowWb9zd6w5UZ18WfCZ" target="_blank" rel="external">https://mp.weixin.qq.com/s?__biz=MzA5MzY4NTQwMA==&amp;mid=2650996942&amp;idx=1&amp;sn=02c335aeb0a431b361bc3ca90a9f8c8f&amp;chksm=8badb339bcda3a2f4ec026c80801cde6d13525cf0e8086fdddbb296c81ca6376fee03051bb88&amp;scene=0&amp;key=cd1928819323f84574591249d8d3b9558858fe07bf89a18626fdd6898b1737bb4416db7ace18aa87a5cfccb1f8648859e19f4abbba71899999dbe650037ac3b1dd755384fcad1b5ee43178472da4e306&amp;ascene=0&amp;uin=Njc2NjQ1NjIw&amp;devicetype=iMac+MacBookPro12%2C1+OSX+OSX+10.12+build(16A323)&amp;version=12010210&amp;nettype=WIFI&amp;fontScale=100&amp;pass_ticket=xhlLfolsnfhQZK9MMVf8vkzOlZJ8R2EHJTl74x7elmy%2FXOowWb9zd6w5UZ18WfCZ</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>


    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>


          
          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/1.jpeg"
               alt="Liangsi" />
          <p class="site-author-name" itemprop="name">Liangsi</p>
           
              <p class="site-description motion-element" itemprop="description">心有猛虎，细嗅蔷薇</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liangsi</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  


  

</body>
</html>
